import{b as m,u as q,r as n,j as t}from"./index-aU8EXm9Y.js";import{H as Q,a as W,D as A,B as U}from"./BulkImportModal-BH0y7t_B.js";import{E as z}from"./ErrorState-CsjuMY1R.js";const G=async e=>{const s=new URLSearchParams;e!=null&&e.page&&s.append("page",e.page.toString()),e!=null&&e.limit&&s.append("limit",e.limit.toString()),e!=null&&e.search&&s.append("search",e.search),e!=null&&e.sortBy&&s.append("sortBy",e.sortBy),e!=null&&e.sortOrder&&s.append("sortOrder",e.sortOrder);const r=s.toString(),g=`/admin/api/staff${r?`?${r}`:""}`;return await m.get(g)},J=async e=>await m.post("/admin/api/staff",e),K=async(e,s)=>await m.put(`/admin/api/staff/${e}`,s),V=async e=>await m.delete(`/admin/api/staff/${e}`);function _(){const{success:e,error:s}=q(),[r,g]=n.useState([]),[p,b]=n.useState(!1),[h,j]=n.useState(null),[D,c]=n.useState(!1),[d,u]=n.useState(),[L,S]=n.useState(!1),[y,x]=n.useState(),[M,v]=n.useState(!1),[O,k]=n.useState(!1),[B,w]=n.useState(!1),[i,I]=n.useState({page:1,limit:10,total:0,totalPages:1}),[f,N]=n.useState(""),o=n.useCallback(async(a=1,C="")=>{b(!0),j(null);try{const l=await G({page:a,limit:i.limit,search:C});g(l.data||[]),I({page:l.page||1,limit:l.limit||10,total:l.total||0,totalPages:l.totalPages||1})}catch{j("Failed to load staff members. Please check your connection and try again."),s("Failed to load staff")}finally{b(!1)}},[i.limit,s]);n.useEffect(()=>{o(1,"")},[o]);const E=a=>{N(a),o(1,a)},P=a=>{o(a,f)},F=async a=>{k(!0);try{d?(await K(d.id,a),e("Staff member updated successfully")):(await J(a),e("Staff member created successfully")),c(!1),u(void 0),await o(i.page,f)}catch{s(d?"Failed to update staff member":"Failed to create staff member")}finally{k(!1)}},H=async()=>{if(y){v(!0);try{await V(y.id),e("Staff member deleted successfully"),S(!1),x(void 0),await o(i.page,f)}catch{s("Failed to delete staff member")}finally{v(!1)}}},$=a=>{u(a),c(!0)},R=a=>{x(a),S(!0)},T=()=>{c(!1),u(void 0)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Staff Management"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Manage internal staff members"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>w(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition",children:t.jsxs("span",{className:"inline-flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Bulk Import"]})}),t.jsx("button",{onClick:()=>{u(void 0),c(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition",children:t.jsxs("span",{className:"inline-flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Staff"]})})]})]}),h&&!p&&t.jsx(z,{title:"Failed to load staff",message:h,onRetry:()=>o(i.page,f)}),!h&&t.jsx(Q,{hosts:r,isLoading:p,pagination:i,onSearch:E,onPageChange:P,onEdit:$,onDelete:R,entityLabel:"staff",hideCompany:!0}),t.jsx(W,{isOpen:D,onClose:T,onSubmit:F,hostData:d,isLoading:O,entityLabel:"Staff",hideCompany:!0}),t.jsx(A,{isOpen:L,host:y,onConfirm:H,onCancel:()=>{S(!1),x(void 0)},isLoading:M,entityLabel:"Staff"}),t.jsx(U,{isOpen:B,onClose:()=>w(!1),onSuccess:()=>{e("Staff imported successfully"),o(1,f)},importEndpoint:"/admin/api/staff/import",title:"Bulk Import Staff"})]})}export{_ as default};
