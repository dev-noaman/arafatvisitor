import{a as B,u as Q,r as s,j as t}from"./index-C4NMOT3W.js";import{H as W,a as X}from"./HostModal-D1U7dzR0.js";import{D as q}from"./DeleteConfirmationDialog-qIPCq97f.js";import{E as z}from"./ErrorState-p7UMj24u.js";import{g as G,u as J,c as K,d as U}from"./hosts-DoFqYo0X.js";function ee(){const{user:u}=B(),v=(u==null?void 0:u.role)==="ADMIN",{success:h,error:n}=Q(),[b,w]=s.useState([]),[x,y]=s.useState(!1),[m,S]=s.useState(null),[C,i]=s.useState(!1),[r,c]=s.useState(),[E,g]=s.useState(!1),[f,p]=s.useState(),[N,H]=s.useState(!1),[L,j]=s.useState(!1),[o,k]=s.useState({page:1,limit:10,total:0,totalPages:1}),[d,M]=s.useState(""),a=s.useCallback(async(e=1,D="")=>{y(!0),S(null);try{const l=await G({page:e,limit:o.limit,search:D,type:"EXTERNAL"});w(l.data||[]),k({page:l.page||1,limit:l.limit||10,total:l.total||0,totalPages:l.totalPages||1})}catch{S("Failed to load hosts. Please check your connection and try again."),n("Failed to load hosts")}finally{y(!1)}},[o.limit,n]);s.useEffect(()=>{a(1,"")},[a]);const F=e=>{M(e),a(1,e)},P=e=>{a(e,d)},A=async e=>{j(!0);try{r?(await J(r.id,e),h("Host updated successfully")):(await K(e),h("Host created successfully")),i(!1),c(void 0),await a(o.page,d)}catch{n(r?"Failed to update host":"Failed to create host")}finally{j(!1)}},I=async()=>{if(f){H(!0);try{await U(f.id),h("Host deleted successfully"),g(!1),p(void 0),await a(o.page,d)}catch{n("Failed to delete host")}finally{H(!1)}}},O=e=>{c(e),i(!0)},T=e=>{p(e),g(!0)},R=()=>{i(!1),c(void 0)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Hosts Management"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Manage companies and host contacts"})]}),v&&t.jsx("div",{className:"flex gap-3",children:t.jsx("button",{onClick:()=>{c(void 0),i(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition",children:t.jsxs("span",{className:"inline-flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Host"]})})})]}),m&&!x&&t.jsx(z,{title:"Failed to load hosts",message:m,onRetry:()=>a(o.page,d)}),!m&&t.jsx(W,{hosts:b,isLoading:x,pagination:o,onSearch:F,onPageChange:P,onEdit:O,onDelete:T,showAddedBy:!0}),t.jsx(X,{isOpen:C,onClose:R,onSubmit:A,hostData:r,isLoading:L}),t.jsx(q,{isOpen:E,host:f,onConfirm:I,onCancel:()=>{g(!1),p(void 0)},isLoading:N})]})}export{ee as default};
