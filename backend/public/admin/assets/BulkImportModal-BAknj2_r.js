import{r as i,j as e,b}from"./index-Di_PL5TG.js";function I({isOpen:f,onClose:N,onSuccess:v,importEndpoint:p="/admin/api/hosts/import",title:y="Bulk Import Hosts",expectedColumns:w,entityLabel:k="record"}){const[u,j]=i.useState(!1),[s,n]=i.useState(null),[g,l]=i.useState(null),[a,x]=i.useState(null),m=i.useRef(null);if(!f)return null;const C=t=>{var d;const r=(d=t.target.files)==null?void 0:d[0];if(r){const o=r.name.toLowerCase().split(".").pop();if(o!=="csv"&&o!=="xlsx"&&o!=="xls"){l("Please select a CSV or Excel file (.csv, .xlsx, .xls)");return}x(r),l(null),n(null)}},L=async()=>{if(!a){l("Please select a file first");return}j(!0),l(null),n(null);try{if(a.name.toLowerCase().split(".").pop()==="csv"){const r=await a.text(),d=await b.post(p,{csvContent:r});n(d)}else{const r=await new Promise((o,S)=>{const c=new FileReader;c.onload=()=>o(c.result),c.onerror=S,c.readAsDataURL(a)}),d=await b.post(p,{xlsxContent:r});n(d)}}catch(t){l((t==null?void 0:t.message)||"Failed to import")}finally{j(!1)}},h=()=>{s&&s.inserted>0&&v(),x(null),n(null),l(null),N()},R=()=>{x(null),n(null),l(null),m.current&&(m.current.value="")};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-gray-50",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:y}),e.jsx("button",{onClick:h,className:"text-gray-500 hover:text-gray-700 transition",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.totalProcessed}),e.jsx("p",{className:"text-sm text-blue-800",children:"Total Processed"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.inserted}),e.jsx("p",{className:"text-sm text-green-800",children:"Added"})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:s.skipped}),e.jsx("p",{className:"text-sm text-yellow-800",children:"Skipped (existing)"})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:s.rejected}),e.jsx("p",{className:"text-sm text-red-800",children:"Rejected"})]})]}),s.rejectedRows.length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-red-800 mb-3",children:["Rejected Rows (",s.rejectedRows.length,")"]}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-red-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-red-800",children:"Row"}),e.jsx("th",{className:"px-3 py-2 text-left text-red-800",children:"Reason"})]})}),e.jsx("tbody",{children:s.rejectedRows.map((t,r)=>e.jsxs("tr",{className:"border-t border-red-200",children:[e.jsx("td",{className:"px-3 py-2 text-red-700",children:t.rowNumber}),e.jsx("td",{className:"px-3 py-2 text-red-700",children:t.reason})]},r))})]})})]}),s.inserted>0&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-green-700",children:["Successfully imported ",s.inserted," ",k,s.inserted!==1?"s":"","!"]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select CSV or Excel File"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 transition",children:[e.jsx("input",{ref:m,type:"file",accept:".csv,.xlsx,.xls",onChange:C,className:"hidden",id:"file-upload"}),e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("p",{className:"text-gray-600 mb-1",children:a?e.jsx("span",{className:"text-blue-600 font-medium",children:a.name}):"Click to upload or drag and drop"}),e.jsx("p",{className:"text-sm text-gray-500",children:"CSV or Excel file (.csv, .xlsx, .xls)"})]})]})]}),w||e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Expected Columns:"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Name"})," - Host name (required)"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Company"})," - Company name (required)"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Email Address"})," - Email (required)"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Phone Number"})," - Phone (optional)"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Location"})," - Arafat - Barwa Towers / Arafat - Element Hotel / Arafat - Marina 50 Tower"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Status"})," - Active / Inactive"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ID"})," - External ID (optional, for updates)"]})]})]}),g&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-red-700",children:g})})]})}),e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end gap-3 bg-gray-50",children:s?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:R,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-100 transition",children:"Import Another"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition",children:"Done"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:h,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-100 transition",children:"Cancel"}),e.jsx("button",{onClick:L,disabled:!a||u,className:"px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-gray-400 transition flex items-center gap-2",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Import"]})})]})})]})})}export{I as B};
