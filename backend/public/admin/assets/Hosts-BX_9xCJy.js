import{a as Q,u as B,r as s,j as t}from"./index-BKpACQqp.js";import{H as W,a as X,D as q}from"./DeleteConfirmationDialog-ttWWMqrV.js";import{E as z}from"./ErrorState-ZMKfceFo.js";import{g as G,u as J,c as K,d as U}from"./hosts-BnGgdk7R.js";function $(){const{user:u}=Q(),v=(u==null?void 0:u.role)==="ADMIN",{success:h,error:n}=B(),[b,C]=s.useState([]),[x,y]=s.useState(!1),[g,S]=s.useState(null),[E,i]=s.useState(!1),[c,r]=s.useState(),[w,m]=s.useState(!1),[f,p]=s.useState(),[N,H]=s.useState(!1),[L,j]=s.useState(!1),[o,k]=s.useState({page:1,limit:10,total:0,totalPages:1}),[d,M]=s.useState(""),a=s.useCallback(async(e=1,D="")=>{y(!0),S(null);try{const l=await G({page:e,limit:o.limit,search:D,type:"EXTERNAL"});C(l.data||[]),k({page:l.page||1,limit:l.limit||10,total:l.total||0,totalPages:l.totalPages||1})}catch{S("Failed to load hosts. Please check your connection and try again."),n("Failed to load hosts")}finally{y(!1)}},[o.limit,n]);s.useEffect(()=>{a(1,"")},[a]);const F=e=>{M(e),a(1,e)},P=e=>{a(e,d)},I=async e=>{j(!0);try{c?(await J(c.id,e),h("Host updated successfully")):(await K(e),h("Host created successfully")),i(!1),r(void 0),await a(o.page,d)}catch{n(c?"Failed to update host":"Failed to create host")}finally{j(!1)}},O=async()=>{if(f){H(!0);try{await U(f.id),h("Host deleted successfully"),m(!1),p(void 0),await a(o.page,d)}catch{n("Failed to delete host")}finally{H(!1)}}},A=e=>{r(e),i(!0)},T=e=>{p(e),m(!0)},R=()=>{i(!1),r(void 0)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Hosts Management"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Manage companies and host contacts"})]}),v&&t.jsx("div",{className:"flex gap-3",children:t.jsx("button",{onClick:()=>{r(void 0),i(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition",children:t.jsxs("span",{className:"inline-flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Host"]})})})]}),g&&!x&&t.jsx(z,{title:"Failed to load hosts",message:g,onRetry:()=>a(o.page,d)}),!g&&t.jsx(W,{hosts:b,isLoading:x,pagination:o,onSearch:F,onPageChange:P,onEdit:A,onDelete:T}),t.jsx(X,{isOpen:E,onClose:R,onSubmit:I,hostData:c,isLoading:L}),t.jsx(q,{isOpen:w,host:f,onConfirm:O,onCancel:()=>{m(!1),p(void 0)},isLoading:N})]})}export{$ as default};
