import{a as W,u as X,r as s,j as e}from"./index-DetM2aOn.js";import"./HostForm-BWuLM12o.js";import{H as q,a as z,D as G}from"./DeleteConfirmationDialog-B9-Udo7O.js";import{B as J}from"./BulkImportModal-C1AKTVLo.js";import{E as K}from"./ErrorState-BVjpvAL5.js";import{g as U,u as V,c as Y,d as Z}from"./hosts-DlgkbYgd.js";function oe(){const{user:m}=W(),D=(m==null?void 0:m.role)==="ADMIN",{success:i,error:r}=X(),[b,C]=s.useState([]),[x,y]=s.useState(!1),[h,j]=s.useState(null),[w,c]=s.useState(!1),[d,u]=s.useState(),[N,p]=s.useState(!1),[g,f]=s.useState(),[L,S]=s.useState(!1),[E,H]=s.useState(!1),[I,v]=s.useState(!1),[o,M]=s.useState({page:1,limit:10,total:0,totalPages:1}),[l,O]=s.useState(""),a=s.useCallback(async(t=1,k="")=>{y(!0),j(null);try{const n=await U({page:t,limit:o.limit,search:k,type:"EXTERNAL"});C(n.data||[]),M({page:n.page||1,limit:n.limit||10,total:n.total||0,totalPages:n.totalPages||1})}catch{j("Failed to load hosts. Please check your connection and try again."),r("Failed to load hosts")}finally{y(!1)}},[o.limit,r]);s.useEffect(()=>{a(1,"")},[a]);const B=t=>{O(t),a(1,t)},F=t=>{a(t,l)},P=async t=>{H(!0);try{d?(await V(d.id,t),i("Host updated successfully")):(await Y(t),i("Host created successfully")),c(!1),u(void 0),await a(o.page,l)}catch{r(d?"Failed to update host":"Failed to create host")}finally{H(!1)}},A=async()=>{if(g){S(!0);try{await Z(g.id),i("Host deleted successfully"),p(!1),f(void 0),await a(o.page,l)}catch{r("Failed to delete host")}finally{S(!1)}}},T=t=>{u(t),c(!0)},R=t=>{f(t),p(!0)},Q=()=>{c(!1),u(void 0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Hosts Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage companies and host contacts"})]}),D&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>v(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition",children:e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Bulk Import"]})}),e.jsx("button",{onClick:()=>{u(void 0),c(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition",children:e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Host"]})})]})]}),h&&!x&&e.jsx(K,{title:"Failed to load hosts",message:h,onRetry:()=>a(o.page,l)}),!h&&e.jsx(q,{hosts:b,isLoading:x,pagination:o,onSearch:B,onPageChange:F,onEdit:T,onDelete:R}),e.jsx(z,{isOpen:w,onClose:Q,onSubmit:P,hostData:d,isLoading:E}),e.jsx(G,{isOpen:N,host:g,onConfirm:A,onCancel:()=>{p(!1),f(void 0)},isLoading:L}),e.jsx(J,{isOpen:I,onClose:()=>v(!1),onSuccess:()=>{i("Hosts imported successfully"),a(1,l)}})]})}export{oe as default};
