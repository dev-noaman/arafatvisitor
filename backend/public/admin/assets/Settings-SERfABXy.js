import{d as E,Z as T,r as p,c as b,j as e,t as f,o as y,s as u,l as I,e as L,b as g,u as H}from"./index-D7dPkE71.js";function K(s){return E(T,s)}const U=y({smtpHost:u().optional(),smtpPort:K().optional(),smtpSecure:L().optional(),smtpUser:u().optional(),smtpPassword:u().optional(),smtpFrom:u().email("Invalid email address").optional().or(I(""))});function z({initialData:s,onSubmit:r,onTest:a,isLoading:t,isTesting:l}){const[i,d]=p.useState(!1),{register:o,handleSubmit:c,formState:{errors:n}}=b({resolver:f(U),defaultValues:{smtpHost:(s==null?void 0:s.smtpHost)||"",smtpPort:(s==null?void 0:s.smtpPort)||587,smtpSecure:(s==null?void 0:s.smtpSecure)||!1,smtpUser:(s==null?void 0:s.smtpUser)||"",smtpPassword:"",smtpFrom:(s==null?void 0:s.smtpFrom)||""}});return e.jsxs("form",{onSubmit:c(r),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"smtpHost",className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Host"}),e.jsx("input",{...o("smtpHost"),type:"text",id:"smtpHost",placeholder:"smtp.example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:t}),n.smtpHost&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.smtpHost.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"smtpPort",className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Port"}),e.jsx("input",{...o("smtpPort"),type:"number",id:"smtpPort",placeholder:"587",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:t}),n.smtpPort&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.smtpPort.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"smtpUser",className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Username"}),e.jsx("input",{...o("smtpUser"),type:"text",id:"smtpUser",placeholder:"your-email@example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:t}),n.smtpUser&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.smtpUser.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"smtpPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{...o("smtpPassword"),type:i?"text":"password",id:"smtpPassword",placeholder:"Leave blank to keep existing",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 pr-10",disabled:t}),e.jsx("button",{type:"button",onClick:()=>d(!i),className:"absolute right-3 top-2.5 text-gray-500 hover:text-gray-700",tabIndex:-1,children:i?e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-4.803c1.079-1.35 2.587-2.417 4.236-2.957"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.879 7.519c1.171-1.025 2.56-1.52 4.121-1.52 3.773 0 6.867 3.06 6.867 6.84 0 1.329-.196 2.605-.57 3.824m2.568-9.64A9 9 0 0121 12a9 9 0 01-9 9m0 0a9 9 0 01-9-9 9 9 0 019-9"})]}):e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),n.smtpPassword&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.smtpPassword.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"smtpFrom",className:"block text-sm font-medium text-gray-700 mb-1",children:"From Email Address"}),e.jsx("input",{...o("smtpFrom"),type:"email",id:"smtpFrom",placeholder:"noreply@example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:t}),n.smtpFrom&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.smtpFrom.message})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{...o("smtpSecure"),type:"checkbox",id:"smtpSecure",className:"h-4 w-4 text-blue-600 focus:ring-2 focus:ring-blue-500 rounded border-gray-300",disabled:t}),e.jsx("label",{htmlFor:"smtpSecure",className:"ml-2 block text-sm text-gray-700",children:"Use TLS/SSL (Secure Connection)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:t||l,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:bg-gray-400 transition",children:t?"Saving...":"Save Settings"}),a&&e.jsx("button",{type:"button",onClick:a,disabled:t||l,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-gray-400 transition",children:l?"Testing...":"Test Email"})]})]})}const B=y({whatsappApiKey:u().optional(),whatsappPhoneNumber:u().optional()});function V({initialData:s,onSubmit:r,onTest:a,isLoading:t,isTesting:l}){const{register:i,handleSubmit:d,formState:{errors:o}}=b({resolver:f(B),defaultValues:{whatsappApiKey:(s==null?void 0:s.whatsappApiKey)||"",whatsappPhoneNumber:(s==null?void 0:s.whatsappPhoneNumber)||""}});return e.jsxs("form",{onSubmit:d(r),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"whatsappApiKey",className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp API Key"}),e.jsx("input",{...i("whatsappApiKey"),type:"password",id:"whatsappApiKey",placeholder:"Enter your WhatsApp API key",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:t}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Get your API key from your WhatsApp Business provider (e.g., wbiztool)"}),o.whatsappApiKey&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.whatsappApiKey.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"whatsappPhoneNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp Phone Number"}),e.jsx("input",{...i("whatsappPhoneNumber"),type:"tel",id:"whatsappPhoneNumber",placeholder:"+974 50707317",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:t}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Include country code (e.g., +974 for Qatar)"}),o.whatsappPhoneNumber&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.whatsappPhoneNumber.message})]}),e.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium",children:"WhatsApp Integration"}),e.jsx("p",{className:"mt-1",children:"Messages will be sent via your configured WhatsApp Business account. Ensure the API key is valid and the phone number is registered."})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:t||l,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:bg-gray-400 transition",children:t?"Saving...":"Save Settings"}),a&&e.jsx("button",{type:"button",onClick:a,disabled:t||l,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-gray-400 transition",children:l?"Testing...":"Test WhatsApp"})]})]})}function S({title:s,description:r,icon:a,status:t,statusColor:l,children:i}){const d={configured:{text:"Configured",bg:"bg-green-50",border:"border-green-200"},incomplete:{text:"Incomplete",bg:"bg-yellow-50",border:"border-yellow-200"},empty:{text:"Not Configured",bg:"bg-gray-50",border:"border-gray-200"}},{text:o,bg:c,border:n}=d[t];return e.jsxs("div",{className:`rounded-lg border p-6 ${c} ${n}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-white ${l}`,children:a}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r})]})]}),e.jsx("div",{children:e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium ${t==="configured"?"bg-green-200 text-green-800":t==="incomplete"?"bg-yellow-200 text-yellow-800":"bg-gray-200 text-gray-800"}`,children:o})})]}),e.jsx("div",{children:i})]})}const $=y({recipientEmail:u().email("Invalid email address")});function R({isOpen:s,onClose:r,onSubmit:a,isLoading:t}){const{register:l,handleSubmit:i,formState:{errors:d},reset:o}=b({resolver:f($),defaultValues:{recipientEmail:""}});p.useEffect(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[s]);const c=async n=>{await a(n),o()};return s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:r}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Test Email Settings"}),e.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700","aria-label":"Close",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:i(c),className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"recipientEmail",className:"block text-sm font-medium text-gray-700 mb-1",children:"Recipient Email Address"}),e.jsx("input",{...l("recipientEmail"),type:"email",id:"recipientEmail",placeholder:"test@example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:t}),d.recipientEmail&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:d.recipientEmail.message})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"A test email will be sent to verify your SMTP settings are working correctly."}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:r,disabled:t,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:bg-gray-100 transition",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:t,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:bg-gray-400 transition",children:t?"Sending...":"Send Test Email"})]})]})]})})]}):null}const O=y({recipientPhone:u().min(10,"Phone number must be at least 10 digits")});function Z({isOpen:s,onClose:r,onSubmit:a,isLoading:t}){const{register:l,handleSubmit:i,formState:{errors:d},reset:o}=b({resolver:f(O),defaultValues:{recipientPhone:""}});p.useEffect(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[s]);const c=async n=>{await a(n),o()};return s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:r}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Test WhatsApp Settings"}),e.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700","aria-label":"Close",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:i(c),className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"recipientPhone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Recipient Phone Number"}),e.jsx("input",{...l("recipientPhone"),type:"tel",id:"recipientPhone",placeholder:"+974 50707317",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:t}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Include country code (e.g., +974)"}),d.recipientPhone&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:d.recipientPhone.message})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"A test message will be sent via WhatsApp to verify your settings are working correctly."}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:r,disabled:t,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:bg-gray-100 transition",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:t,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:bg-gray-400 transition",children:t?"Sending...":"Send Test Message"})]})]})]})})]}):null}const q=async()=>await g.get("/admin/api/settings"),G=async s=>await g.put("/admin/api/settings/smtp",s),Q=async s=>await g.put("/admin/api/settings/whatsapp",s),_=async s=>await g.post("/admin/api/settings/test-email",s),J=async s=>await g.post("/admin/api/settings/test-whatsapp",s),X=s=>s.smtpHost?s.smtpHost&&s.smtpPort&&s.smtpUser&&s.smtpFrom?{status:"configured",color:"text-green-600"}:{status:"incomplete",color:"text-yellow-600"}:{status:"empty",color:"text-gray-400"},Y=s=>s.whatsappApiKey?s.whatsappApiKey&&s.whatsappPhoneNumber?{status:"configured",color:"text-green-600"}:{status:"incomplete",color:"text-yellow-600"}:{status:"empty",color:"text-gray-400"},h={getSettings:q,updateSmtpSettings:G,updateWhatsAppSettings:Q,testEmailSettings:_,testWhatsAppSettings:J,getSmtpStatusIcon:X,getWhatsAppStatusIcon:Y};function ee(){const{success:s,error:r}=H(),[a,t]=p.useState(null),[l,i]=p.useState(!0),[d,o]=p.useState(!1),[c,n]=p.useState(!1),[k,j]=p.useState(!1),[P,w]=p.useState(!1),A=async()=>{i(!0);try{const m=await h.getSettings();t(m)}catch{r("Failed to load settings")}finally{i(!1)}};p.useEffect(()=>{A()},[]);const W=async m=>{o(!0);try{const x=await h.updateSmtpSettings(m);t(x),s("SMTP settings saved successfully")}catch{r("Failed to save SMTP settings")}finally{o(!1)}},C=async m=>{o(!0);try{const x=await h.updateWhatsAppSettings(m);t(x),s("WhatsApp settings saved successfully")}catch{r("Failed to save WhatsApp settings")}finally{o(!1)}},F=async m=>{n(!0);try{await h.testEmailSettings(m),s(`Test email sent to ${m.recipientEmail}`),j(!1)}catch{r("Failed to send test email. Check your settings.")}finally{n(!1)}},M=async m=>{n(!0);try{await h.testWhatsAppSettings(m),s(`Test message sent to ${m.recipientPhone}`),w(!1)}catch{r("Failed to send test message. Check your settings.")}finally{n(!1)}};if(l)return e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!a)return e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"Failed to load settings"})});const N=h.getSmtpStatusIcon(a),v=h.getWhatsAppStatusIcon(a);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"System Settings"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Configure email and messaging services"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsx(S,{title:"Email (SMTP) Configuration",description:"Configure email settings for sending notifications and alerts",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),status:N.status,statusColor:N.color,children:e.jsx(z,{initialData:a,onSubmit:W,onTest:()=>j(!0),isLoading:d,isTesting:c})}),e.jsx(S,{title:"WhatsApp Configuration",description:"Configure WhatsApp integration for sending messages",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V5a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2h-3l-4 4z"})}),status:v.status,statusColor:v.color,children:e.jsx(V,{initialData:a,onSubmit:C,onTest:()=>w(!0),isLoading:d,isTesting:c})})]}),e.jsx("div",{className:"p-6 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium",children:"Configuration Tips"}),e.jsxs("ul",{className:"mt-2 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Save your settings before testing"}),e.jsx("li",{children:"Use the Test buttons to verify your configuration works"}),e.jsx("li",{children:"Keep your API keys and passwords secure"}),e.jsx("li",{children:"Ensure all required fields are filled for the service to work"})]})]})]})}),e.jsx(R,{isOpen:k,onClose:()=>j(!1),onSubmit:F,isLoading:c}),e.jsx(Z,{isOpen:P,onClose:()=>w(!1),onSubmit:M,isLoading:c})]})}export{ee as default};
